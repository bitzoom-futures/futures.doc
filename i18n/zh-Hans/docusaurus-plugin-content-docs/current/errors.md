# 错误码参考

所有 API 响应都使用统一结构；请求失败时会返回错误码与消息。

## 响应结构

成功：

```json
{
  "code": 0,
  "msg": "success",
  "data": {}
}
```

失败：

```json
{
  "code": -1001,
  "msg": "Disconnected from server"
}
```

## 常见错误

| 错误码 | 含义 | 处理建议 |
|--------|------|----------|
| `-1002` | 未授权/Token 过期 | 刷新 JWT 后重试 |
| `-1003` | 触发限频 | 降低请求频率并使用指数退避 |
| `-1021` | 时间戳超出窗口 | 校准本机时间并重试 |
| `-1022` | 签名错误 | 检查签名算法与参数顺序 |
| `-2010` | 余额不足 | 追加保证金或减少下单量 |
| `-2018` | 数量不合法 | 检查最小/最大下单数量 |
| `-2019` | 价格不合法 | 检查价格精度与 tick size |
| `-2021` | 触发价无效 | 调整止损/止盈触发价格 |

## 排查建议

1. 先记录 `traceid` 与请求参数
2. 对 5xx 和网络错误做重试
3. 对鉴权错误优先刷新 Token
4. 对签名错误校验参数排序、编码与时钟

## 签名错误快速修复

1. 确认本机时间与服务器时间偏差不超过 5000ms
2. 使用 HMAC-SHA256
3. 按字母序拼接参数
4. URL 编码参数值

```bash
curl http://119.8.50.236:8088/api/gateway/time
```
